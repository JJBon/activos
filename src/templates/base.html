{% load static %}

<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Base Template</title>
        {% include 'base/css.html' %}
        <!-- {% block base_head %}{% endblock %} para cargar otro css en otra pagina -->
</head>
<body >
    {% include 'base/navbar.html' with brand_name='Activos Fijos' %}
    {% block content %}{% endblock %}

    {% include 'base/js.html' %}

    <!-- first ajax script used for search -->

    <script>
        $(document).ready(function(){
            var searchForm = $("#activos-filters-ajax")
            // print(searchForm)
            console.log('script working')
            console.log(searchForm)

            searchForm.submit(function(event){
                event.preventDefault()
                console.log("Form is not sending")
                var thisForm = $(this)
                //var actionEndpoint =  thisForm.attr("action")
                var actionEndpoint =  thisForm.attr("data-endpoint")
                var httpMethod = thisForm.attr("method")
                var formData = thisForm.serialize();

                //console.log(thisForm.attr("action"),thisForm.attr("method"))
                console.log(formData)

                $.ajax({
                    url: actionEndpoint,
                    method: httpMethod,
                    data: formData,
                    success: function(data){
                        var currentPath = window.location.href
                        var activo_rows = $("#activos_col")
                        if (data.activos.length > 0){
                            activo_rows.html("<tr><td colspan=3>Coming Soon</td></tr>")
                        } else {
                            activo_rows.html("")
                        }

                        console.log("success")
                        console.log(data)
                        if (currentPath.indexOf("activos") != -1) {
                            //updateActivoList(list_html)
                        }
                    },
                    error: function(errorData){
                        console.log("error")
                        console.log(errorData)
                    }
                })

                function updateActivoList(list_html){
                    console.log("in activos list")
                    list_html.html("<h1>Changed</h1>")

                    // refers to endpoint
                    var updateActivosUrl = '/api/activos'
                    var updateActivosMethod = "GET";
                    var data = {};
                    $.ajax({
                        url: updateActivosUrl,
                        method: updateActivosMethod,
                        data: data,
                        sucess: function(data){
                            console.log("success")
                        },
                        error: function(errorData){
                            console.log("error")
                            console.log(errorData)
                        }
                    })

                }
            })
        })
    </script>

</body>
</html>